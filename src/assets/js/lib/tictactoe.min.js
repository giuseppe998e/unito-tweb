/**
 * Copyright (C) 2020 Giuseppe Eletto
 * "TicTacToe.js" is free software: you can redistribute it and/or modify 
 * it under the terms of the GNU Lesser General Public License v3 (or later).
 * More at https://github.com/giuseppe998e/tictactoe-js
 */"use strict";const TicTacToe=function(t){const n={},e=[[0,1,2],[0,3,6],[0,4,8],[1,4,7],[2,4,6],[2,5,8],[3,4,5],[6,7,8]],o={Human:-1,Blank:0,Computer:1},r=(()=>{if("string"!=typeof t||"#"!==t[0])throw"Board not found!";return document.querySelectorAll(`${t} .ttt-box`)})();let l=Array(9).fill(o.Blank),u=0,i=0,a=2,s=o.Human,c=null,m=null,f=null;const d=()=>{const t=w(),e=k();return!(!t&&!e)&&(t?(N()?(console.log('Player "Human" WINS!'),s=o.Human,u+=1):(console.log('Player "Computer" WINS!'),s=o.Computer,i+=1),"function"==typeof c&&c(s==o.Human?"Human":"Computer"),"function"==typeof f&&f(u,i)):e&&(console.log("DRAW!"),"function"==typeof m&&m()),setTimeout(()=>n.init(),350),!0)},p=()=>{if(!N()){let t=-1;switch(a){case 0:t=h();break;case 1:t=H();break;case 2:t=y()}g(t)&&!d()&&(s=o.Human)}},h=()=>{throw"To be implemented!"},H=()=>{throw"To be implemented!"},y=()=>{let t=-2,n=-1;for(let e=0;e<l.length;e++)if(B(e)){const r=l.slice();r[e]=o.Computer;const u=-b(r,o.Human);u>t&&(t=u,n=e)}return n},b=(t,n)=>{const e=C(t);if(!1!==e)return e*n;let o=-2,r=-1;for(let e=0;e<t.length;e++)if(B(e,t)){const l=t.slice();l[e]=n;const u=-b(l,T(n));u>o&&(o=u,r=e)}return-1==r?0:o},g=t=>{if(isNaN(t))throw`"${t}" is not a number!`;return!!B(t)&&(N()?(l[t]=o.Human,r[t].classList.add("human")):(l[t]=o.Computer,r[t].classList.add("computer")),!0)},k=(t=l)=>{for(let n=0;n<t.length;n++)if(B(n,t))return!1;return!0},w=(t=s,n=l)=>C(n)==t,C=(t=l)=>{for(let n=0;n<e.length;n++){const r=e[n],l=t[r[0]];if(l!=o.Blank&&t[r[1]]==l&&t[r[2]]==l)return l}return!1},B=(t,n=l)=>n[t]==o.Blank,N=()=>s==o.Human,T=(t=s)=>{if(1!==t&&-1!==t)throw`${t} is not a valid input!`;return-1*t};return n.init=(()=>{l=Array(9).fill(o.Blank),r.forEach(t=>t.classList.remove("human","computer")),N()||p()}),n.setDifficulty=(t=>{isNaN(t)&&console.error(`"${t}" is not a number!`),t>=0&&t<=2||console.error(`"${t}" is not between 0 and 2 (included)!`),a=t,u=0,i=0,s=o.Human,"function"==typeof f&&f(u,i),n.init()}),n.setWinHandler=(t=>{c=t}),n.setDrawHandler=(t=>{m=t}),n.setPointsHandler=(t=>{f=t}),r.forEach((t,n)=>{t.addEventListener("click",()=>{N()&&g(n)&&!d()&&(s=o.Computer,p())},!1)}),n.init(),n};